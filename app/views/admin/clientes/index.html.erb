<h1 class="text-primary mb-4">üë• Clientes</h1>

<p class="text-muted">Gerencie o cadastro dos clientes da locadora. Clique em um cliente para visualizar detalhes completos e hist√≥rico de empr√©stimos.</p>

<div class="card border-0 shadow-sm mb-4">
  <div class="card-body d-flex flex-column flex-lg-row justify-content-between align-items-lg-center gap-3">
    <div class="btn-group" role="group" aria-label="Exporta√ß√µes">
      <%= link_to "‚¨áÔ∏è Exportar CSV", admin_clientes_path(format: :csv), class: "btn btn-outline-primary" %>
      <%= link_to "üñ®Ô∏è Exportar PDF", admin_clientes_path(format: :pdf), class: "btn btn-outline-primary" %>
    </div>

    <%= form_with url: import_admin_clientes_path, method: :post, local: true, html: { multipart: true, class: "d-flex flex-column flex-sm-row gap-2 align-items-stretch align-items-sm-center" } do |form| %>
      <div>
        <%= form.file_field :file, accept: ".csv", class: "form-control" %>
      </div>
      <%= form.submit "üì§ Importar CSV", class: "btn btn-success" %>
    <% end %>
  </div>
</div>

<div class="alert alert-info" role="alert">
  <strong>Formato esperado do CSV:</strong> cabe√ßalho com <code>Nome</code>, <code>Email</code>, <code>Telefone</code>, <code>Endere√ßo</code>, <code>Data de nascimento</code> (AAAA-MM-DD). O sistema identifica clientes pelo e-mail e atualiza os demais dados automaticamente.
</div>

<div class="card shadow-sm">
  <div class="card-body p-0">
    <% if @clientes.any? %>
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-light">
            <tr>
              <th>#</th>
              <th>Nome</th>
              <th>E-mail</th>
              <th>Telefone</th>
              <th>Empr√©stimos</th>
              <th class="text-end">A√ß√µes</th>
            </tr>
          </thead>
          <tbody>
            <% @clientes.each do |cliente| %>
              <tr>
                <td><%= cliente.id %></td>
                <td><%= cliente.nome %></td>
                <td><%= mail_to cliente.email %></td>
                <td><%= cliente.telefone.presence || "‚Äî" %></td>
                <td>
                  <span class="badge bg-secondary"><%= cliente.emprestimos.size %></span>
                </td>
                <td class="text-end">
                  <%= link_to "Ver detalhes", admin_cliente_path(cliente), class: "btn btn-outline-primary btn-sm" %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% else %>
      <div class="p-4 text-center text-muted">
        Nenhum cliente encontrado at√© o momento.
      </div>
    <% end %>
  </div>
</div>

<div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mt-4">
  <%= paginate @clientes, theme: 'bootstrap-5' %>
  <%= link_to "‚¨ÖÔ∏è Voltar ao Dashboard", admin_root_path, class: "btn btn-secondary" %>
</div>
